<div class="filter-bar-container" [class.embed-mode]="embedMode">
  <!-- Hierarchy Type Display Section - First position - Hidden in embed mode -->
  <div class="hierarchy-type-section" *ngIf="!embedMode">
    <div class="hierarchy-type-value" 
         *ngIf="currentHierarchyType(); else loadingHierarchyType"
         (click)="openHierarchyConfiguration()"
         tabindex="0"
         role="button"
         aria-label="Click to change hierarchy configuration">
      <span class="hierarchy-type-text">{{ currentHierarchyType()?.groupDescText }}</span>
      <span class="hierarchy-type-code">{{ currentHierarchyType()?.hierarchyTypeCode }}</span>
      <svg class="hierarchy-config-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path d="M12 20h9"></path>
        <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
      </svg>
    </div>
    <ng-template #loadingHierarchyType>
      <div class="hierarchy-type-loading">Loading...</div>
    </ng-template>
  </div>

  <div class="divider" *ngIf="!embedMode"></div>


  <!-- Hierarchy Configuration Section - Hidden in embed mode -->
  <div class="hierarchy-section" *ngIf="!embedMode">
    <app-hierarchy-selector 
      [config]="hierarchyConfig()"
      [hierarchyTypes]="hierarchyTypes"
      [compactMode]="true"
      (configChange)="onHierarchyConfigChange($event)">
    </app-hierarchy-selector>
  </div>

  <div class="divider" *ngIf="!embedMode"></div>

  <!-- Export Section - Hidden in embed mode -->
  <div class="export-section" *ngIf="!embedMode">
    <button class="export-button" 
            (click)="exportToExcel()"
            [disabled]="!data || data.length === 0"
            appTooltip="Export data to Excel">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
        <polyline points="14,2 14,8 20,8"/>
        <line x1="16" y1="13" x2="8" y2="13"/>
        <line x1="16" y1="17" x2="8" y2="17"/>
        <polyline points="10,9 9,9 8,9"/>
      </svg>
      <span>Export</span>
    </button>
  </div>
</div>